webpackJsonp([6],{"L+DW":function(e,t){},hL1W:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("G0J2");var s=a("mw3O"),i=a.n(s),n={components:{wMenu:a("zIkb").default,wFooter:a("mzkE").default},data:function(){return{pageSize:10,pageNum:1,totalNum:0,BASE_URL:"http://www.panzhihui.cn/watermelon",BASE_API:"http://www.panzhihui.cn/watermelon_api/",new_diary_date:Date.now(),query_content:"",new_diary_is_show:!1,datalist:[{date:"2019-06-02",content:"例子:只能看到自己的日志和心情"},{date:"2018-01-01",content:"例子:这是许久以前的美好回忆"}],new_diary_content:"",editorOption:{modules:{toolbar:[["bold","italic","underline","strike",{header:[]},{size:[]}],["code-block",{list:"ordered"},{list:"bullet"}]]}}}},methods:{handleSizeChange:function(e){this.pageSize=e,this.query()},handleCurrentChange:function(e){this.pageNum=e,this.query()},query:function(){var e=this;this.$axios.post(this.BASE_API+"diary/select",i.a.stringify({content:this.query_content,pageSize:this.pageSize,pageNum:this.pageNum}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){console.log(t),1==t.data.success?(e.datalist=t.data.data.list,e.totalNum=t.data.data.total):t.data.message&&"用户未登录"==t.data.message?(e.$message({showClose:!0,type:"error",message:"登录后使用记事"}),sessionStorage.removeItem("customerId"),sessionStorage.removeItem("customerPhone"),sessionStorage.removeItem("customerNickname"),this.$router.push({name:"login"})):e.$message({showClose:!0,type:"error",message:t.data.message})}).catch(function(e){console.log(e)})},new_diary_button:function(){var e=this;this.$axios.post(this.BASE_API+"diary/insert",i.a.stringify({date:this.dateFormat(this.new_diary_date),content:this.new_diary_content}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){console.log(t),1==t.data.success?(e.new_diary_content="",e.new_diary_is_show=!1,e.query()):t.data.message&&"用户未登录"==t.data.message?(e.$message({showClose:!0,type:"error",message:"长时间未操作,请重新登录后再记事."}),sessionStorage.removeItem("customerId"),sessionStorage.removeItem("customerPhone"),sessionStorage.removeItem("customerNickname")):e.$message({showClose:!0,type:"error",message:t.data.message})}).catch(function(e){console.log(e)})},show_new_diary:function(){this.new_diary_is_show?this.new_diary_is_show=!1:this.new_diary_is_show=!0},click_edit_diary:function(e){this.datalist[e].edit?this.datalist[e].edit=!1:this.datalist[e].edit=!0,console.log("change edit to = "+this.datalist[e].edit),this.new_diary_is_show=!this.new_diary_is_show,this.new_diary_is_show=!this.new_diary_is_show},save_edit_diary_button:function(e,t){var a=this;this.$axios.post(this.BASE_API+"diary/update",i.a.stringify({id:t.id,content:t.content}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){console.log(e),1==e.data.success?a.$message({showClose:!0,message:"保存成功",type:"success"}):a.$message({showClose:!0,type:"error",message:e.data.message})}).catch(function(e){console.log(e)})},save_edit_diary_button_close:function(e,t){var a=this;this.$axios.post(this.BASE_API+"diary/update",i.a.stringify({id:t.id,content:t.content}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){console.log(t),1==t.data.success?(a.datalist[e].edit?a.datalist[e].edit=!1:a.datalist[e].edit=!0,console.log("change edit to = "+a.datalist[e].edit),a.new_diary_is_show=!a.new_diary_is_show,a.new_diary_is_show=!a.new_diary_is_show,a.$message({showClose:!0,message:"保存成功",type:"success"})):a.$message({showClose:!0,type:"error",message:t.data.message})}).catch(function(e){console.log(e)})},dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},mounted:function(){this.query()}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"w-max-width"},[a("wMenu"),e._v(" "),a("br"),e._v(" "),a("el-form",{staticClass:"demo-form-inline w-aligncenter",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"请输入您需要查找的内容"},model:{value:e.query_content,callback:function(t){e.query_content=t},expression:"query_content"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),e._v(" "),e.new_diary_is_show?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.show_new_diary}},[e._v("开始记事")]),e._v(" "),e.new_diary_is_show?a("el-button",{attrs:{type:"primary"},on:{click:e.show_new_diary}},[e._v("关闭记事")]):e._e()],1)],1),e._v(" "),a("div",{staticClass:"block w-diary"},[a("el-timeline",[e.new_diary_is_show?a("el-timeline-item",{attrs:{timestamp:e.dateFormat(e.new_diary_date),placement:"top"}},[a("el-card",[[a("el-row",{staticClass:"w-marginbottom w-aligncenter",attrs:{gutter:10}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.new_diary_date,callback:function(t){e.new_diary_date=t},expression:"new_diary_date"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.new_diary_button}},[e._v("保存")])],1),e._v(" "),a("quill-editor",{ref:"myQuillEditor",model:{value:e.new_diary_content,callback:function(t){e.new_diary_content=t},expression:"new_diary_content"}})]],2)],1):e._e(),e._v(" "),e._l(e.datalist,function(t,s){return a("el-timeline-item",{key:s,attrs:{timestamp:t.date,placement:"top"}},[a("el-card",[t.edit?e._e():a("p",{domProps:{innerHTML:e._s(t.content)}}),e._v(" "),t.edit?a("p",[a("quill-editor",{ref:"myQuillEditor",refInFor:!0,model:{value:t.content,callback:function(a){e.$set(t,"content",a)},expression:"item.content"}})],1):e._e(),e._v(" "),a("div",{staticClass:"card_bottom"},[a("span",{staticClass:"card_bottom_item",on:{click:function(t){return e.click_edit_diary(s)}}},[e._v("编辑")]),e._v(" "),t.edit?a("span",{staticClass:"card_bottom_item",on:{click:function(a){return e.save_edit_diary_button(s,t)}}},[e._v("保存")]):e._e(),e._v(" "),t.edit?a("span",{staticClass:"card_bottom_item",on:{click:function(a){return e.save_edit_diary_button_close(s,t)}}},[e._v("保存且关闭编辑")]):e._e()])])],1)})],2)],1),e._v(" "),a("div",{staticClass:"pageController"},[a("el-pagination",{attrs:{layout:"sizes,prev, pager, next","page-sizes":[10,50,100],"page-size":10,total:e.totalNum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("wFooter")],1)},staticRenderFns:[]};var r=a("VU/8")(n,o,!1,function(e){a("L+DW")},null,null);t.default=r.exports}});
//# sourceMappingURL=6.5dcfc675dba332161dfa.1571037191297.js.map